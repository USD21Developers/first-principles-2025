<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bible Gateway Test</title>
    <style type="text/css">
      #bg_popup-container .bg_popup.bg_popup-outer {
        left: unset !important;
      }

      a.bibleref {
        color: initial;
        cursor: pointer;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="bibleref">Acts 11:25-36</div>

    <div id="scripture"></div>

    <script>
      const htmlEl = document.querySelector("html");
      const bibles = {
        en: "NIV",
        es: "NVI",
      };

      document.querySelectorAll(".bibleref").forEach((item) => {
        const lang = htmlEl.getAttribute("lang");
        const scripture = item.innerText;
        const bibleVersion = "NVI" || bibles[lang];
        item.addEventListener("click", (event) => {
          const url = `https://www.biblegateway.com/share/tooltips/data/?search=${scripture}&version=${bibleVersion}&callback=BGLinks.updateTooltip`;
          const bg = document.createElement("script");
          bg.setAttribute("src", url);
          document.querySelector("head").appendChild(bg);
        });
      });

      const BGLinks = {
        updateTooltip: (args) => {
          const { reference, reference_display, text, version, version_url } =
            args;

          debugger;

          document.querySelector("#scripture").innerHTML = text;
        },
      };
    </script>

    <!-- <script
      src="https://www.biblegateway.com/public/link-to-us/tooltips/bglinks.js"
      type="text/javascript"
    ></script>
    <script type="text/javascript">
      BGLinks.version = "NVI";
      BGLinks.linkVerses();
      document.querySelectorAll("a.bibleref").forEach((link) => {
        link.addEventListener("click", (event) => {
          event.preventDefault();

          const mouseOverEvent = new MouseEvent("mouseover", {
            bubbles: true,
            cancelable: true,
            view: window,
          });

          event.target.dispatchEvent(mouseOverEvent);
        });
      });
    </script> -->
  </body>
</html>
